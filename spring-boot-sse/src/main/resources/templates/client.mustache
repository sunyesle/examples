<html lang="ko">
<head>
    <title>SSE Client</title>
</head>
<body>
<h1>SSE Client</h1>

<label for="userId">User ID:</label>
<input type="text" id="userId" placeholder="Enter User ID">
<button id="connectBtn">Connect</button>

<br><br>
<textarea id="log" rows="15" cols="80" readonly></textarea>

<script>
    document.getElementById("connectBtn").addEventListener("click", function() {
        const userId = document.getElementById("userId").value.trim();
        const logArea = document.getElementById("log");

        if (!userId) {
            logArea.value += "âš ï¸ userIdë¥¼ ìž…ë ¥í•˜ì„¸ìš”.\n";
            return;
        }

        const url = `/api/sse/connect?userId=${encodeURIComponent(userId)}`;
        const eventSource = new EventSource(url);

        logArea.value += `ðŸš€ SSE ì—°ê²° ì‹œë„ ì¤‘... (userId=${userId})\n`;

        eventSource.onopen = e => {
            logArea.value += "âœ… SSE ì—°ê²° ì—´ë¦¼\n";
        };

        eventSource.onerror = e => {
            logArea.value += "âŒ SSE ì˜¤ë¥˜ ë°œìƒ\n";
            eventSource.close();
        };

        eventSource.addEventListener("connect", e => {
            logArea.value += `ðŸ“¥ [connect] ${e.data}\n`;
        });

        eventSource.addEventListener("broadcast", e => {
            logArea.value += `ðŸ“¥ [broadcast] ${e.data}\n`;
        });

        eventSource.addEventListener("send", e => {
            logArea.value += `ðŸ“¥ [send] ${e.data}\n`;
        });
    });
</script>
</body>
</html>
